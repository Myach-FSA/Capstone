<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Welcome to Firebase Hosting</title>

  <!-- update the version number as needed -->
  <script defer src="/__/firebase/4.2.0/firebase-app.js"></script>
  <!-- include only the Firebase features as you need -->
  <script defer src="/__/firebase/4.2.0/firebase-auth.js"></script>
  <script defer src="/__/firebase/4.2.0/firebase-database.js"></script>
  <script defer src="/__/firebase/4.2.0/firebase-messaging.js"></script>
  <script defer src="/__/firebase/4.2.0/firebase-storage.js"></script>
  <!-- initialize the SDK after all desired features are loaded -->
  <script defer src="/__/firebase/init.js"></script>
  <script src="bundle.js" defer></script>
  <style media="screen">
    body {
      background: #ECEFF1;
      color: rgba(0, 0, 0, 0.87);
      font-family: Roboto, Helvetica, Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    @media (max-width: 600px) {
      body,
      #message {
        margin-top: 0;
        background: white;
        box-shadow: none;
      }
      body {
        border-top: 16px solid #ffa100;
      }
    }

    html,
    body {
      overflow: hidden;
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
    }

    #renderCanvas {
      width: 100%;
      height: 100%;
      touch-action: none;
    }
  </style>
  <script src="babylon.js"></script>
  <!-- <script src="hand.js"></script> -->
  <script src="cannon.js"></script>
</head>

<body>
  <div>
    <canvas id="renderCanvas"></canvas>
    <script type="text/javascript">
      var canvas = document.querySelector("#renderCanvas");
      var engine = new BABYLON.Engine(canvas, true);

      var createScene = function () {
        var scene = new BABYLON.Scene(engine);
        var gravityVector = new BABYLON.Vector3(0, -9.81, 0);
        var physicsPlugin = new BABYLON.CannonJSPlugin();
        scene.enablePhysics(gravityVector, physicsPlugin);
        scene.clearColor = new BABYLON.Color3(0, 1, 0);

        // This creates and positions a free camera
        // var camera = new BABYLON.FreeCamera("camera1", new BABYLON.Vector3(0, 5, -10), scene);
        // // This targets the camera to scene origin
        // camera.setTarget(BABYLON.Vector3.Zero());
        // // This attaches the camera to the canvas
        // camera.attachControl(canvas, false);
        // // This creates a light, aiming 0,1,0 - to the sky.
        var light = new BABYLON.HemisphericLight("light1", new BABYLON.Vector3(0, 1, 0), scene);
        // Dim the light a small amount
        light.intensity = .5;
        // Let's try our built-in 'sphere' shape. Params: name, subdivisions, size, scene
        var sphere = BABYLON.Mesh.CreateSphere("sphere1", 8, 1, scene);
        // Move the sphere upward 1/2 its height

    // FollowCamera >> Follow a mesh through your scene
    // Parameters : name, position, scene
    var followCamera = new BABYLON.FollowCamera("followCam", new BABYLON.Vector3(0, 15, -45), scene);
    // camera.lockedTarget = sphere; // target any mesh or object with a "position" Vector3
    followCamera.radius = 10; // how far from the object to follow
    followCamera.heightOffset = 5; // how high above the object to place the camera
    followCamera.rotationOffset = 180; // the viewing angle
    followCamera.cameraAcceleration = 0.05 // how fast to move
    followCamera.maxCameraSpeed = 10 // speed limit
    followCamera.attachControl(canvas,true);
    scene.activeCamera = followCamera;
    followCamera.lockedTarget = sphere;

    // // Create a very small simple mesh.
    // var followObject = BABYLON.Mesh.CreateSphere("followObject", 0.001, scene);
    // // Set its position to be the same as the ball's position.
    // followObject.position = ball.position;
    

        sphere.position.y = 1;
        //Change the texture of the sphere to wireframe to show rotation
        var materialSphere = new BABYLON.StandardMaterial("texture1", scene);
        materialSphere.wireframe = true;
        sphere.material = materialSphere;
        // Let's try our built-in 'ground' shape. Params: name, width, depth, subdivisions, scene
        var ground = BABYLON.Mesh.CreateGround("ground1", 10, 10, 2, scene);

        sphere.physicsImpostor = new BABYLON.PhysicsImpostor(sphere, BABYLON.PhysicsImpostor.SphereImpostor, { mass: 1, restitution: 0.9 }, scene);
        ground.physicsImpostor = new BABYLON.PhysicsImpostor(ground, BABYLON.PhysicsImpostor.BoxImpostor, { mass: 0, restitution: 0.9 }, scene);

        sphere.physicsImpostor.setAngularVelocity(new BABYLON.Quaternion(0, 0, 0, 0));

        let zAxis = 0;
        let xAxis = 0;
        window.onkeydown = function (e) {
          if (e.keyCode === 37) {
            xAxis += .25;
            sphere.physicsImpostor.setAngularVelocity(new BABYLON.Quaternion(zAxis, 0, xAxis, 0));
          }
          if (e.keyCode === 39) {
            xAxis -= .25;
            sphere.physicsImpostor.setAngularVelocity(new BABYLON.Quaternion(zAxis, 0, xAxis, 0));
          }
          if (e.keyCode === 38) {
            zAxis += .25;
            sphere.physicsImpostor.setAngularVelocity(new BABYLON.Quaternion(zAxis, 0, xAxis, 0));
          }
          if (e.keyCode === 40) {
            zAxis -= .25;
            sphere.physicsImpostor.setAngularVelocity(new BABYLON.Quaternion(zAxis, 0, xAxis, 0));
          }
        }
        return scene;
      }; // End of createScene function
      // -------------------------------------------------------------
      // Now, call the createScene function that you just finished creating
      var scene = createScene();
      // Register a render loop to repeatedly render the scene
      engine.runRenderLoop(function () {
        scene.render();
      });
      // Watch for browser/canvas resize events
      window.addEventListener("resize", function () {
        engine.resize();
      });
    </script>
  </div>
  <p id="load">Firebase SDK Loading&hellip;</p>

  <script>
      document.addEventListener('DOMContentLoaded', function () {
        // // ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
        // // The Firebase SDK is initialized and available here!
        //
        // firebase.auth().onAuthStateChanged(user => { });
        // firebase.database().ref('/path/to/ref').on('value', snapshot => { });
        // firebase.messaging().requestPermission().then(() => { });
        // firebase.storage().ref('/path/to/ref').getDownloadURL().then(() => { });
        //
        // // ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥

        try {
          let app = firebase.app();
          let features = ['auth', 'database', 'messaging', 'storage'].filter(feature => typeof app[feature] === 'function');
          document.getElementById('load').innerHTML = `Firebase SDK loaded with ${features.join(', ')}`;
        } catch (e) {
          console.error(e);
          document.getElementById('load').innerHTML = 'Error loading the Firebase SDK, check the console.';
        }
      });
  </script>
</body>

</html>
