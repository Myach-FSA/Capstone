<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Welcome to Firebase Hosting</title>

  <!-- update the version number as needed -->
  <script defer src="/__/firebase/4.2.0/firebase-app.js"></script>
  <!-- include only the Firebase features as you need -->
  <script defer src="/__/firebase/4.2.0/firebase-auth.js"></script>
  <script defer src="/__/firebase/4.2.0/firebase-database.js"></script>
  <script defer src="/__/firebase/4.2.0/firebase-messaging.js"></script>
  <script defer src="/__/firebase/4.2.0/firebase-storage.js"></script>
  <!-- initialize the SDK after all desired features are loaded -->
  <script defer src="/__/firebase/init.js"></script>
  <script src="bundle.js" defer></script>
  <style media="screen">
    body {
      background: #ECEFF1;
      color: rgba(0, 0, 0, 0.87);
      font-family: Roboto, Helvetica, Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    @media (max-width: 600px) {
      body,
      #message {
        margin-top: 0;
        background: white;
        box-shadow: none;
      }
      body {
        border-top: 16px solid #ffa100;
      }
    }

    html,
    body {
      overflow: hidden;
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
    }

    #renderCanvas {
      width: 100%;
      height: 100%;
      touch-action: none;
    }
  </style>
  <script src="babylon.js"></script>
  <!-- <script src="hand.js"></script> -->
  <script src="cannon.js"></script>
</head>

<body>
  <div>
    <canvas id="renderCanvas"></canvas>
    <script type="text/javascript">
      window.addEventListener('DOMContentLoaded', function () {
        // your code here
        var canvas = document.getElementById('renderCanvas');
        var engine = new BABYLON.Engine(canvas, true);
        var createScene = function () {
          var scene = new BABYLON.Scene(engine);
          var gravityVector = new BABYLON.Vector3(0, -9.81, 0);
          var physicsPlugin = new BABYLON.CannonJSPlugin();
          scene.enablePhysics(gravityVector, physicsPlugin);
          scene.collisionsEnabled = true;

          var camera = new BABYLON.FreeCamera("camera1", new BABYLON.Vector3(0, 20, -40), scene);
          camera.setTarget(BABYLON.Vector3.Zero());
          camera.attachControl(canvas, false);
          var light = new BABYLON.HemisphericLight("light1", new BABYLON.Vector3(0, 1, 0), scene);
          light.intensity = 0.7;

          // Our built-in 'sphere' shape. Params: name, subdivs, size, scene
          var sphere1 = BABYLON.Mesh.CreateSphere("sphere1", 16, 2, scene);
          sphere1.position.y = 2;
          sphere1.checkCollisions = true;

          var ground = BABYLON.Mesh.CreateGround("ground1", 50, 50, 2, scene);
          ground.checkCollisions = true;

          var sphere2 = BABYLON.Mesh.CreateSphere("sphere2", 32, 2, scene);
          sphere2.position.y = 4;
          sphere2.position.x = 4;
          sphere2.checkCollisions = true;

          var curvePoints = function (l, t) {
            var path = [];
            var step = l / t;
            var a = 5;
            for (var i = -l / 2; i < l / 2; i += step) {
              path.push(new BABYLON.Vector3(5 * Math.sin(i * t / 400), i, 5 * Math.cos(i * t / 400)));
            }
            return path;
          };
          var curve = curvePoints(40, 100);

          sphere1.physicsImpostor = new BABYLON.PhysicsImpostor(sphere1, BABYLON.PhysicsImpostor.SphereImpostor, {
            mass: 0.01,
            friction: 0.5,
            restitution: 0.7
          }, scene);
          ground.physicsImpostor = new BABYLON.PhysicsImpostor(ground, BABYLON.PhysicsImpostor.BoxImpostor, {
            mass: 0,
            restitution: 0.9
          }, scene);
          sphere2.physicsImpostor = new BABYLON.PhysicsImpostor(sphere2, BABYLON.PhysicsImpostor.SphereImpostor, {
            mass: 0.01,
            friction: 0.5,
            restitution: 0.7
          }, scene);

          let zAxis = 0;
          let xAxis = 0;
          let yAxis = 0;
          function moveLeft(obj) {
            if (xAxis < 3) {
              xAxis += 1;
            }
            obj.physicsImpostor.setAngularVelocity(new BABYLON.Quaternion(yAxis, 0, xAxis, 0));
          }
          function moveRight(obj) {
            if (xAxis > -3) {
              xAxis -= 1;
            }
            obj.physicsImpostor.setAngularVelocity(new BABYLON.Quaternion(yAxis, 0, xAxis, 0));
          }
          function moveUp(obj) {
            if (yAxis < 3) {
              yAxis += 1;
            }
            obj.physicsImpostor.setAngularVelocity(new BABYLON.Quaternion(yAxis, 0, xAxis, 0));
          }
          function moveDown(obj) {
            if (yAxis > -3) {
              yAxis -= 1;
            }
            obj.physicsImpostor.setAngularVelocity(new BABYLON.Quaternion(yAxis, 0, xAxis, 0));
          }
          window.onkeydown = function (e) {
            if (e.key === ' ') {
              sphere1.position.y = 4;
            }
            if (e.key === 'ArrowLeft') {
              moveLeft(sphere1)
            }
            if (e.key === 'ArrowRight') {
              moveRight(sphere1);
            }
            if (e.key === 'ArrowUp') {
              moveUp(sphere1);
            }
            if (e.key === 'ArrowDown') {
              moveDown(sphere1);
            }
          }
          var ballMaterial = new BABYLON.StandardMaterial('material', scene);
          var tubeMaterial = new BABYLON.StandardMaterial('material', scene);
          var textureTube = new BABYLON.Texture('stone.png', scene);
          var textureBall = new BABYLON.Texture('net.png', scene);
          ballMaterial.diffuseColor = new BABYLON.Color3(2.0, 1, 0.7);
          ballMaterial.diffuseTexture = textureBall;
          ballMaterial.diffuseTexture.hasAlpha = true;
          sphere1.material = ballMaterial;
          tubeMaterial.diffuseTexture = textureTube;
          sphere2.material = tubeMaterial;
          var groundMaterial = new BABYLON.StandardMaterial('material', scene);
          var textureGrass = new BABYLON.Texture('grass-large.png', scene);
          groundMaterial.diffuseTexture = textureGrass;
          ground.material = groundMaterial;
          return scene;
        };
        var scene = createScene();
        engine.runRenderLoop(function () {
          scene.render();
        });
        window.addEventListener('resize', function () {
          engine.resize();
        });
      });
    </script>
  </div>
  <p id="load">Firebase SDK Loading&hellip;</p>


  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // // ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
      // // The Firebase SDK is initialized and available here!
      //
      // firebase.auth().onAuthStateChanged(user => { });
      // firebase.database().ref('/path/to/ref').on('value', snapshot => { });
      // firebase.messaging().requestPermission().then(() => { });
      // firebase.storage().ref('/path/to/ref').getDownloadURL().then(() => { });
      //
      // // ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥

      try {
        let app = firebase.app();
        let features = ['auth', 'database', 'messaging', 'storage'].filter(feature => typeof app[feature] === 'function');
        document.getElementById('load').innerHTML = `Firebase SDK loaded with ${features.join(', ')}`;
      } catch (e) {
        console.error(e);
        document.getElementById('load').innerHTML = 'Error loading the Firebase SDK, check the console.';
      }
    });
  </script>
</body>

</html>
